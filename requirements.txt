import os
import logging
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes

# Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±
logging.basicConfig(format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO)
logger = logging.getLogger(__name__)

# ØªÙˆÚ©Ù† Ø±Ø¨Ø§Øª
BOT_TOKEN = os.getenv("BOT_TOKEN", "ØªÙˆÚ©Ù†_Ø±Ø¨Ø§Øª_ØªÙˆ_Ø§ÛŒÙ†Ø¬Ø§")

# Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ùˆ
main_menu = [
    ["ğŸ“¦ Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú© Ø±Ø¨Ø§Øª", "ğŸ§ª ØªØ³Øª Ø±Ø§ÛŒÚ¯Ø§Ù† Ø±Ø¨Ø§Øª"],
    ["ğŸ¥ ÙˆÛŒØ¯ÛŒÙˆ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø±Ø¨Ø§Øª", "ğŸ“ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ"],
    ["ğŸ“˜ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡", "â“ Ø³ÙˆØ§Ù„Ø§Øª Ù…ØªØ¯Ø§ÙˆÙ„"]
]

# Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
welcome_text = "Ø³Ù„Ø§Ù… ğŸ‘‹\nØ¨Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø±Ø³Ù…ÛŒ MaxTraderr Ø®ÙˆØ´ Ø§ÙˆÙ…Ø¯ÛŒ âœ¨\nÙ„Ø·ÙØ§Ù‹ ÛŒÚ©ÛŒ Ø§Ø² Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù† ğŸ‘‡"
subscribe_text = """ğŸ’³ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú© Ø±Ø¨Ø§Øª:\n1ï¸âƒ£ Ù…Ø§Ù‡Ø§Ù†Ù‡ - 49$\n2ï¸âƒ£ Ø³Ù‡â€ŒÙ…Ø§Ù‡Ù‡ - 129$\n3ï¸âƒ£ Ø´Ø´â€ŒÙ…Ø§Ù‡Ù‡ - 239$\n\nØ¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª Ùˆ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø¨Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù¾ÛŒØ§Ù… Ø¨Ø¯Ù‡."""
trial_text = """ğŸ§ª ØªØ³Øª Ø±Ø§ÛŒÚ¯Ø§Ù† Û· Ø±ÙˆØ²Ù‡:\nÛŒÙˆØ²Ø±Ù†ÛŒÙ… Ù…ØªØ§ØªØ±ÛŒØ¯Ø±ØªÙˆ Ø¨ÙØ±Ø³Øª Ø¨Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªØ§ ÙØ¹Ø§Ù„ Ø¨Ø´Ù‡ âœ¨"""
video_text = """ğŸ¥ ÙˆÛŒØ¯ÛŒÙˆÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø±Ø¨Ø§Øª:\nhttps://t.me/maxtraderr/10"""
support_text = """ğŸ“ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ:\n@MaxTraderrSupport"""
guide_text = """ğŸ“˜ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡:\n1ï¸âƒ£ Ø§Ú©Ø³Ù¾Ø±Øª Ø±Ùˆ Ø¨Ø±ÛŒØ² Ø¯Ø§Ø®Ù„ Ù…ØªØ§ØªØ±ÛŒØ¯Ø±\n2ï¸âƒ£ Ø±ÙˆÛŒ Ú†Ø§Ø±Øª M1 ÛŒØ§ H1 Ø¨Ù†Ø¯Ø§Ø²\n3ï¸âƒ£ Ø®ÙˆØ¯Ø´ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù…Ø¹Ø§Ù…Ù„Ù‡ Ù…ÛŒâ€ŒØ²Ù†Ù‡"""
faq_text = """â“ Ø³ÙˆØ§Ù„Ø§Øª Ù…ØªØ¯Ø§ÙˆÙ„:\n\nğŸ’  Ø±ÙˆÛŒ Ù‡Ù…Ù‡ Ø¨Ø±ÙˆÚ©Ø±Ù‡Ø§ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù‡ØŸ\nØ¨Ù„Ù‡ØŒ ØªØ³Øª Ø´Ø¯Ù‡.\n\nğŸ’  VPS Ù„Ø§Ø²Ù…Ù‡ØŸ\nÙ¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…ÛŒØ´Ù‡ Ø¨Ø±Ø§ÛŒ Ù¾Ø§ÛŒØ¯Ø§Ø±ÛŒ."""

help_text = """ğŸ¤– Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¯Ø³ØªÙˆØ±Ø§Øª:
/start - Ø´Ø±ÙˆØ¹
/help - Ø±Ø§Ù‡Ù†Ù…Ø§

Ø§Ø² Ù…Ù†ÙˆÛŒ Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ ğŸ‘‡"""

# start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(welcome_text, reply_markup=ReplyKeyboardMarkup(main_menu, resize_keyboard=True))

# help
async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(help_text, reply_markup=ReplyKeyboardMarkup(main_menu, resize_keyboard=True))

# Ù‡Ù†Ø¯Ù„ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text.strip()

    if text == "ğŸ“¦ Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú© Ø±Ø¨Ø§Øª":
        await update.message.reply_text(subscribe_text)
    elif text == "ğŸ§ª ØªØ³Øª Ø±Ø§ÛŒÚ¯Ø§Ù† Ø±Ø¨Ø§Øª":
        await update.message.reply_text(trial_text)
    elif text == "ğŸ¥ ÙˆÛŒØ¯ÛŒÙˆ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø±Ø¨Ø§Øª":
        await update.message.reply_text(video_text)
    elif text == "ğŸ“ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ":
        await update.message.reply_text(support_text)
    elif text == "ğŸ“˜ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡":
        await update.message.reply_text(guide_text)
    elif text == "â“ Ø³ÙˆØ§Ù„Ø§Øª Ù…ØªØ¯Ø§ÙˆÙ„":
        await update.message.reply_text(faq_text)
    else:
        await update.message.reply_text("Ú¯Ø²ÛŒÙ†Ù‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø±Ù‡. Ù„Ø·ÙØ§Ù‹ Ø§Ø² Ù…Ù†ÙˆÛŒ Ø²ÛŒØ± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù† ğŸ‘‡", reply_markup=ReplyKeyboardMarkup(main_menu, resize_keyboard=True))

# Ù‡Ù†Ø¯Ù„ Ø®Ø·Ø§
async def error_handler(update, context):
    logger.error(f"Update error: {context.error}")
    if isinstance(update, Update) and update.message:
        await update.message.reply_text("Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯. Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†.")

# main
def main():
    if not BOT_TOKEN or BOT_TOKEN == "7951072696:AAEmDDiXpnxgdTG6ZbBMTYCXgLYyeCqKlBA"
        print("âŒ Bot token Ø±Ùˆ Ø¨Ø§ÛŒØ¯ Ø³Øª Ú©Ù†ÛŒ")
        return

    app = Application.builder().token(BOT_TOKEN).build()

    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("help", help_command))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    app.add_error_handler(error_handler)

    print("ğŸ¤– MaxTraderr Support Bot is running...")
    app.run_polling()

if __name__ == "__main__":
    main()
